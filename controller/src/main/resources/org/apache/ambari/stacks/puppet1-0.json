{
  "@name":"puppet1",
  "repositories":{
    "@kind":"TAR",
    "urls":"http://www.apache.org/dist/hadoop/common/"
  },
  "default_user_group":{
    "@user":"hadoop",
    "@userid":"",
    "@group":"hadoop",
    "@groupid":""
  },
  "globals":[
          {
            "@name":"ambari_namenode_principal",
            "@value":"nn"
          },
          {
            "@name":"ambari_datanode_principal",
            "@value":"dn"
          },
          {
            "@name":"ambari_jobtracker_principal",
            "@value":"jt"
          },
          {
            "@name":"ambari_tasktracker_principal",
            "@value":"tt"
          },
          {
            "@name":"ambari_hbasemaster_principal",
            "@value":"hm"
          },
          {
            "@name":"ambari_regionserver_principal",
            "@value":"rs"
          },
          {
            "@name":"ambari_hcat_principal",
            "@value":"hcat"
          },
          {
            "@name":"ambari_user_realm",
            "@value":"KERBEROS.EXAMPLE.COM"
          },
          {
            "@name":"ambari_service_realm",
            "@value":"<%= ambari_user_realm %>"
          },
          {
            "@name":"ambari_keytab_dir",
            "@value":"/etc/security/keytabs"
          },
          {
            "@name":"ambari_auth_to_local",
            "@value":"RULE:[1:$1@$0](.*@<%= ambari_user_realm %>)s/@.*//\nRULE:[2:$1@$0](<%= ambari_jobtracker_principal %>@<%= ambari_service_realm %>)s/.*/<%= ambari_mapreduce_user %>/\nRULE:[2:$1@$0](<%= ambari_tasktracker_principal %>@<%= ambari_service_realm %>)s/.*/<%= ambari_mapreduce_user %>/\nRULE:[2:$1@$0](<%= ambari_namenode_principal %>@<%= ambari_service_realm %>)s/.*/<%= ambari_hdfs_user %>/\nRULE:[2:$1@$0](<%= ambari_datanode_principal %>@<%= ambari_service_realm %>)s/.*/<%= ambari_hdfs_user %>/"
          }
        ],
  "configuration":{
    "category":[
      {
        "@name":"core-site.xml",
        "property":[
          {
            "@name":"fs.default.name",
            "@value":"hdfs://<%= ambari_namenode_host %>:8020"
          },
          {
            "@name":"fs.trash.interval",
            "@value":"360"
          },
          {
            "@name":"hadoop.security.authentication",
            "@value":"simple"
          },
          {
            "@name":"hadoop.security.authorization",
            "@value":"false"
          },
          {
            "@name":"hadoop.kerberos.kinit.command",
            "@value":"/usr/kerberos/bin/kinit"
          },
          {
            "@name":"local.realm",
            "@value":"<%= ambari_user_realm %>"
          }
        ]
      },
      {
        "@name":"hdfs-site.xml",
        "property":[
          {
            "@name":"dfs.http.address",
            "@value":"<%= ambari_namenode_host %>:50070"
          },
          {
            "@name":"dfs.umaskmode",
            "@value":"077"
          },
          {
            "@name":"dfs.block.access.token.enable",
            "@value":"false"
          },
          {
            "@name":"dfs.namenode.kerberos.principal",
            "@value":"<%= ambari_namenode_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.namenode.kerberos.https.principal",
            "@value":"host/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.secondary.namenode.kerberos.principal",
            "@value":"<%= ambari_namenode_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.secondary.namenode.kerberos.https.principal",
            "@value":"host/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.datanode.kerberos.principal",
            "@value":"<%= ambari_datanode_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.web.authentication.kerberos.principal",
            "@value":"HTTP/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"dfs.https.address",
            "@value":"<%= ambari_namenode_host %>:50470"
          },
          {
            "@name":"dfs.secondary.http.address",
            "@value":"<%= ambari_namenode_host %>:50090"
          },
          {
            "@name":"dfs.support.append",
            "@value":"true"
          }
        ]
      },
      {
        "@name":"hadoop-env.sh",
        "property":[
          {
            "@name":"JAVA_HOME",
            "@value":"/usr/java/latest"
          },
          {
            "@name":"HADOOP_CONF_DIR",
            "@value":"<%= ambari_role_prefix %>/etc/conf"
          },
          {
            "@name":"HADOOP_OPTS",
            "@value":"-Djava.net.preferIPv4Stack=true $HADOOP_OPTS"
          },
          {
            "@name":"HADOOP_CLIENT_OPTS",
            "@value":"-Xmx128m $HADOOP_CLIENT_OPTS"
          }
        ]
      },
      {
        "@name":"mapred-site.xml",
        "property":[
          {
            "@name":"mapred.tasktracker.tasks.sleeptime-before-sigkill",
            "@value":"250"
          },
          {
            "@name":"mapred.system.dir",
            "@value":"/mapred/mapredsystem"
          },
          {
            "@name":"mapred.job.tracker",
            "@value":"<%= ambari_jobtracker_host %>:9000"
          },
          {
            "@name":"mapred.job.tracker.http.address",
            "@value":"<%= ambari_jobtracker_host %>:50030"
          },
          {
            "@name":"mapred.local.dir",
            "@value":"<%= ambari_role_prefix %>/mapred/local"
          },
          {
            "@name":"mapreduce.cluster.administrators",
            "@value":"<%= ambari_mapreduce_user %>"
          },
          {
            "@name":"mapred.map.tasks.speculative.execution",
            "@value":"false"
          },
          {
            "@name":"mapred.reduce.tasks.speculative.execution",
            "@value":"false"
          },
          {
            "@name":"mapred.output.compression.type",
            "@value":"BLOCK"
          },
          {
            "@name":"jetty.connector",
            "@value":"org.mortbay.jetty.nio.SelectChannelConnector"
          },
          {
            "@name":"mapred.task.tracker.task-controller",
            "@value":"org.apache.hadoop.mapred.DefaultTaskController"
          },
          {
            "@name":"mapred.child.root.logger",
            "@value":"INFO,TLA"
          },
          {
            "@name":"mapred.child.java.opts",
            "@value":"-server -Xmx640m -Djava.net.preferIPv4Stack=true"
          },
          {
            "@name":"mapred.child.ulimit",
            "@value":"8388608"
          },
          {
            "@name":"mapred.job.tracker.persist.jobstatus.active",
            "@value":"true"
          },
          {
            "@name":"mapred.job.tracker.persist.jobstatus.dir",
            "@value":"file:///<%= ambari_role_prefix %>/jobstatus/<%= ambari_jobtracker_principal %>"
          },
          {
            "@name":"mapred.job.tracker.history.completed.location",
            "@value":"/mapred/history/done"
          },
          {
            "@name":"mapred.heartbeats.in.second",
            "@value":"200"
          },
          {
            "@name":"mapreduce.tasktracker.outofband.heartbeat",
            "@value":"true"
          },
          {
            "@name":"mapred.jobtracker.maxtasks.per.job",
            "@value":"200000"
          },
          {
            "@name":"mapreduce.jobtracker.kerberos.principal",
            "@value":"<%= ambari_jobtracker_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"mapreduce.tasktracker.kerberos.principal",
            "@value":"<%= ambari_tasktracker_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"hadoop.job.history.user.location",
            "@value":"none"
          },
          {
            "@name":"mapreduce.jobtracker.keytab.file",
            "@value":"/etc/security/keytabs/jt.service.keytab"
          },
          {
            "@name":"mapreduce.tasktracker.keytab.file",
            "@value":"/etc/security/keytabs/tt.service.keytab"
          },
          {
            "@name":"mapreduce.jobtracker.staging.root.dir",
            "@value":"/user"
          },
          {
            "@name":"mapreduce.job.acl-modify-job",
            "@value":""
          },
          {
            "@name":"mapreduce.job.acl-view-job",
            "@value":"Dr.Who"
          },
          {
            "@name":"mapreduce.tasktracker.group",
            "@value":"<%= ambari_tasktracker_group %>"
          },
          {
            "@name":"mapred.acls.enabled",
            "@value":"true"
          },
          {
            "@name":"mapred.jobtracker.taskScheduler",
            "@value":"org.apache.hadoop.mapred.CapacityTaskScheduler"
          },
          {
            "@name":"mapred.queue.names",
            "@value":"default"
          },
          {
            "@name":"mapreduce.history.server.embedded",
            "@value":"false"
          },
          {
            "@name":"mapreduce.history.server.http.address",
            "@value":"<%= ambari_jobtracker_host %>:51111"
          },
          {
            "@name":"mapreduce.jobhistory.kerberos.principal",
            "@value":"<%= ambari_jobtracker_principal %>/_HOST@<%= ambari_service_realm %>"
          },
          {
            "@name":"mapreduce.jobhistory.keytab.file",
            "@value":"/etc/security/keytabs/jt.service.keytab"
          },
          {
            "@name":"mapred.hosts",
            "@value":"<%= ambari_role_prefix %>/etc/hadoop/mapred.include"
          },
          {
            "@name":"mapred.hosts.exclude",
            "@value":"<%= ambari_role_prefix %>/etc/hadoop/mapred.exclude"
          },
          {
            "@name":"mapred.jobtracker.retirejob.check",
            "@value":"10000"
          },
          {
            "@name":"mapred.jobtracker.retirejob.interval",
            "@value":"0"
          }
        ]
      }
    ]
  },
  "components":[
    {
      "@name":"common",
      "@architecture":"x86_64",
      "@version":"0.20.205.0",
      "@provider":"org.apache.hadoop",
      "definition":{
        "@provider":"org.apache.ambari",
        "@name":"hadoop-common",
        "@version":"0.1.0"
      }
    },
    {
      "@name":"mapreduce",
      "@architecture":"x86_64",
      "@version":"0.20.205.0",
      "@provider":"org.apache.hadoop",
      "definition":{
        "@provider":"org.apache.ambari",
        "@name":"mapreduce",
        "@version":"0.1.0"
      },
      "configuration":{
        "category":[
          {
            "@name":"core-site.xml",
            "property":[
              {
                "@name":"hadoop.security.auth_to_local",
                "@value":"<%= ambari_auth_to_local %>"
              },
              {
                "@name":"hadoop.security.groups.cache.secs",
                "@value":"14400"
              },
              {
                "@name":"hadoop.http.filter.initializers",
                "@value":"org.apache.hadoop.http.lib.StaticUserWebFilter"
              }
            ]
          },
          {
            "@name":"hadoop-metrics2.properties",
            "property":{
              "@name":"*.period",
              "@value":"60"
            }
          },
          {
            "@name":"capacity-scheduler.xml",
            "property":[
                {
                  "@name":"mapred.capacity-scheduler.maximum-system-jobs",
                  "@value":"3000"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.capacity",
                  "@value":"100"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.maximum-capacity",
                  "@value":"-1"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.supports-priority",
                  "@value":"false"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.minimum-user-limit-percent",
                  "@value":"100"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.user-limit-factor",
                  "@value":"1"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.maximum-initialized-active-tasks",
                  "@value":"200000"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.maximum-initialized-active-tasks-per-user",
                  "@value":"100000"
                },
                {
                  "@name":"mapred.capacity-scheduler.queue.default.init-accept-jobs-factor",
                  "@value":"10"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-supports-priority",
                  "@value":"false"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-minimum-user-limit-percent",
                  "@value":"100"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-user-limit-factor",
                  "@value":"1"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-maximum-active-tasks-per-queue",
                  "@value":"200000"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-maximum-active-tasks-per-user",
                  "@value":"100000"
                },
                {
                  "@name":"mapred.capacity-scheduler.default-init-accept-jobs-factor",
                  "@value":"10"
                },
                {
                  "@name":"mapred.capacity-scheduler.init-poll-interval",
                  "@value":"5000"
                },
                {
                  "@name":"mapred.capacity-scheduler.init-worker-threads",
                  "@value":"5"
                }
              ]
          },
          {
            "@name":"taskcontroller.cfg",
            "property":[
                {
                  "@name":"mapreduce.cluster.local.dir",
                  "@value":"<%= ambari_role_prefix %>/mapred/local"
                },
                {
                  "@name":"mapreduce.tasktracker.group",
                  "@value":"<%= ambari_tasktracker_group %>"
                },
                {
                  "@name":"hadoop.log.dir",
                  "@value":"<%= ambari_role_prefix %>/logs"
                }
              ]
          },
          {
            "@name":"hadoop-env.sh",
            "property":[
                {
                  "@name":"HADOOP_CONF_DIR",
                  "@value":"<%= ambari_role_prefix %>/etc/hadoop"
                },
                {
                  "@name":"HADOOP_JOBTRACKER_OPTS",
                  "@value":"-Dsecurity.audit.logger=INFO,DRFAS -Dmapred.audit.logger=INFO,MRAUDIT -Dhadoop.mapreduce.jobsummary.logger=INFO,JSA $HADOOP_JOBTRACKER_OPTS"
                },
                {
                  "@name":"HADOOP_TASKTRACKER_OPTS",
                  "@value":"-Dsecurity.audit.logger=ERROR,console -Dmapred.audit.logger=ERROR,console $HADOOP_TASKTRACKER_OPTS"
                },
                {
                  "@name":"HADOOP_LOG_DIR",
                  "@value":"<%= ambari_role_prefix %>/logs"
                },
                {
                  "@name":"HADOOP_PID_DIR",
                  "@value":"<%= ambari_role_prefix %>/pids"
                },
                {
                  "@name":"HADOOP_IDENT_STRING",
                  "@value":"<%= ambari_cluster_name %>"
                }
            ]
          }
        ]
      }
    },
    {
      "@name":"hdfs",
      "@provider":"org.apache.hadoop",
      "definition":{
        "@provider":"org.apache.ambari",
        "@name":"hdfs",
        "@version":"0.1.0"
      },
      "configuration":{
        "category":[
          {
            "@name":"core-site.xml",
            "property":[
              {
                "@name":"hadoop.security.auth_to_local",
                "@value":"<%= ambari_auth_to_local %>"
              },
              {
                "@name":"hadoop.security.groups.cache.secs",
                "@value":"14400"
              },
              {
                "@name":"hadoop.http.filter.initializers",
                "@value":"org.apache.hadoop.http.lib.StaticUserWebFilter"
              }
            ]
          },
          {
            "@name":"hdfs-site.xml",
            "property":[
              {
                "@name":"dfs.name.dir",
                "@value":"<%= ambari_role_prefix %>/hdfs/name"
              },
              {
                "@name":"dfs.data.dir",
                "@value":"<%= ambari_role_prefix %>/hdfs/data"
              },
              {
                "@name":"dfs.safemode.threshold.pct",
                "@value":"1.0f"
              },
              {
                "@name":"dfs.datanode.address",
                "@value":"0.0.0.0:50010"
              },
              {
                "@name":"dfs.datanode.http.address",
                "@value":"0.0.0.0:50075"
              },
              {
                "@name":"dfs.web.authentication.kerberos.keytab",
                "@value":"<%= ambari_keytab_dir %>/<%= ambari_namenode_principal %>.service.keytab"
              },
              {
                "@name":"dfs.namenode.keytab.file",
                "@value":"<%= ambari_keytab_dir %>/<%= ambari_namenode_principal %>.service.keytab"
              },
              {
                "@name":"dfs.secondary.namenode.keytab.file",
                "@value":"<%= ambari_keytab_dir %>/<%= ambari_namenode_principal %>.service.keytab"
              },
              {
                "@name":"dfs.datanode.keytab.file",
                "@value":"<%= ambari_keytab_dir %>/<%= ambari_datanode_principal %>.service.keytab"
              },
              {
                "@name":"dfs.secondary.https.port",
                "@value":"50490"
              },
              {
                "@name":"dfs.https.port",
                "@value":"50470"
              },
              {
                "@name":"dfs.https.address",
                "@value":"<%= ambari_namenode_host %>:50470"
              },
              {
                "@name":"dfs.datanode.data.dir.perm",
                "@value":"700"
              },
              {
                "@name":"dfs.cluster.administrators",
                "@value":"<%= ambari_hdfs_user %>"
              },
              {
                "@name":"dfs.permissions.superusergroup",
                "@value":"<%= ambari_hdfs_group %>"
              },
              {
                "@name":"dfs.secondary.http.address",
                "@value":"<%= ambari_namenode_host %>:50090"
              },
              {
                "@name":"dfs.hosts",
                "@value":"<%= ambari_role_prefix %>/etc/hadoop/dfs.include"
              },
              {
                "@name":"dfs.hosts.exclude",
                "@value":"<%= ambari_role_prefix %>/etc/hadoop/dfs.exclude"
              },
              {
                "@name":"dfs.webhdfs.enabled",
                "@value":"true"
              }
            ]
          },
          {
            "@name":"hadoop-env.sh",
            "property":[
              {
                "@name":"HADOOP_CONF_DIR",
                "@value":"<%= ambari_role_prefix %>/etc/hadoop"
              },
              {
                "@name":"HADOOP_NAMENODE_OPTS",
                "@value":"-Dsecurity.audit.logger=INFO,DRFAS -Dhdfs.audit.logger=INFO,DRFAAUDIT"
              },
              {
                "@name":"HADOOP_SECONDARYNAMENODE_OPTS",
                "@value":"-Dsecurity.audit.logger=INFO,DRFAS -Dhdfs.audit.logger=INFO,DRFAAUDIT"
              },
              {
                "@name":"HADOOP_DATANODE_OPTS",
                "@value":"-Dsecurity.audit.logger=ERROR,DRFAS"
              },
              {
                "@name":"HADOOP_SECURE_DN_USER",
                "@value":""
              },
              {
                "@name":"HADOOP_LOG_DIR",
                "@value":"<%= ambari_role_prefix %>/logs"
              },
              {
                "@name":"HADOOP_SECURE_DN_LOG_DIR",
                "@value":"<%= ambari_role_prefix %>/logs/secure"
              },
              {
                "@name":"HADOOP_PID_DIR",
                "@value":"<%= ambari_role_prefix %>/pids"
              },
              {
                "@name":"HADOOP_SECURE_DN_PID_DIR",
                "@value":"<%= ambari_role_prefix %>/pids/secure"
              },
              {
                "@name":"HADOOP_IDENT_STRING",
                "@value":"<%= ambari_cluster_name %>"
              }
            ]
          },
          {
            "@name":"hadoop-metrics2.properties",
            "property":{
              "@name":"*.period",
              "@value":"60"
            }
          }
        ]
      }
    }
  ]
}
