{"version":3,"sources":["../../.tmp/datepicker/bs-datepicker-input.directive.ts"],"names":[],"mappings":"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","file":"bs-datepicker-input.directive.js","sourceRoot":"","sourcesContent":["import { Directive, ElementRef, forwardRef, Host, OnInit, Renderer } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BsDatepickerComponent } from './bs-datepicker.component';\nimport { formatDate } from '../bs-moment/format';\nimport { BsDatepickerConfig } from './bs-datepicker.config';\nimport { getLocale } from '../bs-moment/locale/locales.service';\n\nconst BS_DATEPICKER_VALUE_ACCESSOR = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => BsDatepickerInputDirective),\n  multi: true\n};\n\n\nexport class BsDatepickerInputDirective\n  implements OnInit, ControlValueAccessor {\n\n  private _onChange = Function.prototype;\n  private _onTouched = Function.prototype;\n\n  constructor( private _picker: BsDatepickerComponent,\n              private _config: BsDatepickerConfig,\n              private _renderer: Renderer,\n              private _elRef: ElementRef) {\n  }\n\n  ngOnInit(): void {\n    this._picker.bsValueChange.subscribe((v: Date) => {\n      this._renderer.setElementProperty(\n        this._elRef.nativeElement,\n        'value',\n        formatDate(v, this._picker._config.dateInputFormat, this._picker._config.locale) || ''\n      );\n      this._onChange(v);\n    });\n  }\n\n  onChange(event: any) {\n    this.writeValue(event.target.value);\n    this._onTouched();\n  }\n\n  writeValue(value: Date | string) {\n    if (!value) {\n      this._picker.bsValue = null;\n    }\n    const _locale = getLocale(this._picker._config.locale);\n    if (!_locale) {\n      throw new Error(`Locale \"${this._picker._config.locale}\" is not defined, please add it with \"defineLocale(...)\"`);\n    }\n    if (typeof value === 'string') {\n      const date = new Date(_locale.preparse(value));\n      this._picker.bsValue = isNaN(date.valueOf()) ? null : date;\n    }\n\n    if (value instanceof Date) {\n      this._picker.bsValue = value;\n    }\n  }\n\n  setDisabledState(isDisabled: boolean): void {\n    this._picker.isDisabled = isDisabled;\n    this._renderer.setElementAttribute(this._elRef.nativeElement, 'disabled', 'disabled');\n  }\n\n  registerOnChange(fn: (value: any) => any): void { this._onChange = fn; }\n\n  registerOnTouched(fn: () => any): void { this._onTouched = fn; }\n\n  onBlur() { this._onTouched(); }\n\n  hide() {\n    this._picker.hide();\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: `input[bsDatepicker]`,\n  host: {\n    '(change)': 'onChange($event)',\n    '(keyup.esc)': 'hide()',\n    '(blur)': 'onBlur()'\n  },\n  providers: [BS_DATEPICKER_VALUE_ACCESSOR]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: BsDatepickerComponent, decorators: [{ type: Host }, ]},\n{type: BsDatepickerConfig, },\n{type: Renderer, },\n{type: ElementRef, },\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}