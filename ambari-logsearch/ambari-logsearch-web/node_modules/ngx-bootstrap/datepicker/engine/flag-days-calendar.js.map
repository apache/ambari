{"version":3,"sources":["../../../.tmp/datepicker/engine/flag-days-calendar.ts"],"names":[],"mappings":"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","file":"flag-days-calendar.js","sourceRoot":"","sourcesContent":["import { DaysCalendarViewModel, DayViewModel, WeekViewModel } from '../models/index';\nimport { isSameDay, isSameMonth } from '../../bs-moment/utils/date-getters';\nimport { isAfter, isBefore } from '../../bs-moment/utils/date-compare';\nimport { isMonthDisabled } from '../utils/bs-calendar-utils';\nimport { shiftDate } from '../../bs-moment/utils/date-setters';\n\nexport interface FlagDaysCalendarOptions {\n  isDisabled: boolean;\n  minDate: Date;\n  maxDate: Date;\n  hoveredDate: Date;\n  selectedDate: Date;\n  selectedRange: Date[];\n  displayMonths: number;\n  monthIndex: number;\n}\n\nexport function flagDaysCalendar(formattedMonth: DaysCalendarViewModel,\n                                 options: FlagDaysCalendarOptions): DaysCalendarViewModel {\n  formattedMonth.weeks\n    .forEach((week: WeekViewModel, weekIndex: number) => {\n      week.days.forEach((day: DayViewModel, dayIndex: number) => {\n        // datepicker\n        const isOtherMonth = !isSameMonth(day.date, formattedMonth.month);\n\n        const isHovered = !isOtherMonth && isSameDay(day.date, options.hoveredDate);\n        // date range picker\n        const isSelectionStart = !isOtherMonth\n          && options.selectedRange\n          && isSameDay(day.date, options.selectedRange[0]);\n        const isSelectionEnd = !isOtherMonth\n          && options.selectedRange\n          && isSameDay(day.date, options.selectedRange[1]);\n\n        const isSelected = !isOtherMonth && isSameDay(day.date, options.selectedDate) ||\n          isSelectionStart || isSelectionEnd;\n\n        const isInRange = !isOtherMonth\n          && options.selectedRange\n          && isDateInRange(day.date, options.selectedRange, options.hoveredDate);\n\n        const isDisabled = options.isDisabled\n          || isBefore(day.date, options.minDate, 'day')\n          || isAfter(day.date, options.maxDate, 'day');\n\n        // decide update or not\n        const newDay = Object.assign({}, day, {\n          isOtherMonth,\n          isHovered,\n          isSelected,\n          isSelectionStart,\n          isSelectionEnd,\n          isInRange,\n          isDisabled\n        });\n\n        if (day.isOtherMonth !== newDay.isOtherMonth ||\n          day.isHovered !== newDay.isHovered ||\n          day.isSelected !== newDay.isSelected ||\n          day.isSelectionStart !== newDay.isSelectionStart ||\n          day.isSelectionEnd !== newDay.isSelectionEnd ||\n          day.isDisabled !== newDay.isDisabled ||\n          day.isInRange !== newDay.isInRange) {\n          week.days[dayIndex] = newDay;\n        }\n      });\n    });\n\n  // todo: add check for linked calendars\n  formattedMonth.hideLeftArrow = options.isDisabled\n    || (options.monthIndex > 0\n    && options.monthIndex !== options.displayMonths);\n  formattedMonth.hideRightArrow = options.isDisabled\n    || (options.monthIndex < options.displayMonths\n    && (options.monthIndex + 1) !== options.displayMonths);\n\n  formattedMonth.disableLeftArrow = isMonthDisabled(\n    shiftDate(formattedMonth.month, {month: -1}),\n    options.minDate,\n    options.maxDate);\n  formattedMonth.disableRightArrow = isMonthDisabled(\n    shiftDate(formattedMonth.month, {month: 1}),\n    options.minDate,\n    options.maxDate);\n\n  return formattedMonth;\n}\n\nfunction isDateInRange(date: Date, selectedRange: Date[], hoveredDate: Date): boolean {\n  if (!date || !selectedRange[0]) {\n    return false;\n  }\n\n  if (selectedRange[1]) {\n    return date > selectedRange[0] && date <= selectedRange[1];\n  }\n\n  if (hoveredDate) {\n    return date > selectedRange[0] && date <= hoveredDate;\n  }\n\n  return false;\n}\n"]}