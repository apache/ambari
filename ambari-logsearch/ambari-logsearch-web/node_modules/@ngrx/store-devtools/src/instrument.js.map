{"version":3,"sources":["../../src/instrument.ts"],"names":[],"mappings":"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","file":"instrument.js","sourceRoot":"","sourcesContent":["import { NgModule, OpaqueToken, Injector, ModuleWithProviders } from '@angular/core';\nimport { StoreModule, State, INITIAL_STATE, INITIAL_REDUCER, Dispatcher, Reducer } from '@ngrx/store';\nimport { Observable } from 'rxjs/Observable';\nimport { StoreDevtools, DevtoolsDispatcher } from './devtools';\nimport { StoreDevtoolsConfig, STORE_DEVTOOLS_CONFIG, INITIAL_OPTIONS } from './config';\nimport { DevtoolsExtension, REDUX_DEVTOOLS_EXTENSION } from './extension';\n\n\nexport function _createReduxDevtoolsExtension() {\n  const legacyExtensionKey = 'devToolsExtension';\n  const extensionKey = '__REDUX_DEVTOOLS_EXTENSION__';\n\n  if (typeof window === 'object' && typeof window[legacyExtensionKey] !== 'undefined') {\n    return window[legacyExtensionKey];\n  }\n  else if (typeof window === 'object' && typeof window[extensionKey] !== 'undefined') {\n    return window[extensionKey];\n  }\n  else {\n    return null;\n  }\n}\n\nexport function _createState(devtools: StoreDevtools) {\n  return devtools.state;\n}\n\nexport function _createReducer(dispatcher: DevtoolsDispatcher, reducer) {\n  return new Reducer(dispatcher, reducer);\n}\n\nexport function _createStateIfExtension(extension: any, injector: Injector, initialState: any) {\n  if (!!extension) {\n    const devtools: StoreDevtools = injector.get(StoreDevtools);\n\n    return _createState(devtools);\n  }\n  else {\n    const dispatcher: Dispatcher = injector.get(Dispatcher);\n    const reducer: Reducer = injector.get(Reducer);\n\n    return new State(initialState, dispatcher, reducer);\n  }\n}\n\nexport function _createReducerIfExtension(extension: any, injector: Injector, reducer: any) {\n  if (!!extension) {\n    const devtoolsDispatcher: DevtoolsDispatcher = injector.get(DevtoolsDispatcher);\n\n    return _createReducer(devtoolsDispatcher, reducer);\n  }\n  else {\n    const dispatcher: Dispatcher = injector.get(Dispatcher);\n\n    return new Reducer(dispatcher, reducer);\n  }\n}\n\nexport function noMonitor() {\n  return null;\n}\n\nexport function _createOptions(_options): StoreDevtoolsConfig {\n  const DEFAULT_OPTIONS: StoreDevtoolsConfig = { monitor: noMonitor };\n\n  let options = typeof _options === 'function' ? _options() : _options;\n\n  options = Object.assign({}, DEFAULT_OPTIONS, options);\n\n  if (options.maxAge && options.maxAge < 2) {\n    throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${options.maxAge}`);\n  }\n\n  return options;\n}\n\n\nexport class StoreDevtoolsModule {\n  static instrumentStore(_options: StoreDevtoolsConfig | (() => StoreDevtoolsConfig) = {}): ModuleWithProviders {\n\n    return {\n      ngModule: StoreDevtoolsModule,\n      providers: [\n        {\n          provide: State,\n          deps: [ StoreDevtools ],\n          useFactory: _createState\n        },\n        {\n          provide: INITIAL_OPTIONS,\n          useValue: _options\n        },\n        {\n          provide: Reducer,\n          deps: [ DevtoolsDispatcher, INITIAL_REDUCER ],\n          useFactory: _createReducer\n        },\n        {\n          provide: STORE_DEVTOOLS_CONFIG,\n          deps: [INITIAL_OPTIONS],\n          useFactory: _createOptions\n        }\n      ]\n    };\n  }\n\n  static instrumentOnlyWithExtension(_options: StoreDevtoolsConfig | (() => StoreDevtoolsConfig) = {}): ModuleWithProviders {\n    return {\n      ngModule: StoreDevtoolsModule,\n      providers: [\n        {\n          provide: State,\n          deps: [ REDUX_DEVTOOLS_EXTENSION, Injector, INITIAL_STATE ],\n          useFactory: _createStateIfExtension\n        },\n        {\n          provide: Reducer,\n          deps: [ REDUX_DEVTOOLS_EXTENSION, Injector, INITIAL_REDUCER ],\n          useFactory: _createReducerIfExtension\n        },\n        {\n          provide: INITIAL_OPTIONS,\n          useValue: _options\n        },\n        {\n          provide: STORE_DEVTOOLS_CONFIG,\n          deps: [INITIAL_OPTIONS],\n          useFactory: _createOptions\n        }\n      ]\n    };\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n  imports: [\n    StoreModule\n  ],\n  providers: [\n    DevtoolsExtension,\n    DevtoolsDispatcher,\n    StoreDevtools,\n    {\n      provide: REDUX_DEVTOOLS_EXTENSION,\n      useFactory: _createReduxDevtoolsExtension\n    }\n  ]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}