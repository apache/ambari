!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r():"function"==typeof define&&define.amd?define(r):r()}(this,function(){"use strict";function t(){return new Error(u)}function r(){try{throw t()}catch(r){return r}}function a(t){return t.stack?t.stack.split(o):[]}function e(t,r){for(var e=a(r),n=0;n<e.length;n++){var c=e[n];s.hasOwnProperty(c)||t.push(e[n])}}function n(t,r){var a=[r?r.trim():""];if(t)for(var n=(new Date).getTime(),c=0;c<t.length;c++){var i=t[c],s=i.timestamp,f="____________________Elapsed "+(n-s.getTime())+" ms; At: "+s;f=f.replace(/[^\w\d]/g,"_"),a.push(k.replace(_,f)),e(a,i.error),n=s.getTime()}return a.join(o)}function c(t,r){r>0&&(t.push(a((new h).error)),c(t,r-1))}function i(){if(!(Error.stackTraceLimit<=0)){var t=[];c(t,2);for(var r=t[0],a=t[1],e=0;e<r.length;e++){var n=r[e];if(n.indexOf(u)==-1){var i=n.match(/^\s*at\s+/);if(i){k=i[0]+_+" (http://localhost)";break}}}for(var e=0;e<r.length;e++){var n=r[e],o=a[e];if(n!==o)break;s[n]=!0}}}var o="\n",s={},f="__creationTrace__",u="STACKTRACE TRACKING",_="__SEP_TAG__",k=_+"@[native]",h=function(){function t(){this.error=T(),this.timestamp=new Date}return t}(),l=t(),d=r(),T=l.stack?t:d.stack?r:t;Zone.longStackTraceZoneSpec={name:"long-stack-trace",longStackTraceLimit:10,getLongStackTrace:function(t){if(t){var r=t[Zone.__symbol__("currentTask")],a=r&&r.data&&r.data[f];return a?n(a,t.stack):t.stack}},onScheduleTask:function(t,r,a,e){if(Error.stackTraceLimit>0){var n=Zone.currentTask,c=n&&n.data&&n.data[f]||[];c=[new h].concat(c),c.length>this.longStackTraceLimit&&(c.length=this.longStackTraceLimit),e.data||(e.data={}),e.data[f]=c}return t.scheduleTask(a,e)},onHandleError:function(t,r,a,e){if(Error.stackTraceLimit>0){var c=Zone.currentTask||e.task;if(e instanceof Error&&c){var i=n(c.data&&c.data[f],e.stack);try{e.stack=e.longStack=i}catch(o){}}}return t.handleError(a,e)}},i()});